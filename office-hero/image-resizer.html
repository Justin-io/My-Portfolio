<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Resizer | Office Hero</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container">
        <div class="back-nav">
            <a href="../index.html#utilities" class="back-btn">
                <i class="fas fa-arrow-left"></i> Back to Tools
            </a>
        </div>

        <header>
            <div class="icon-box" style="margin: 0 auto 1.5rem auto;">
                <i class="fas fa-crop-alt"></i>
            </div>
            <h1 class="brand">Social Media Resizer</h1>
            <p class="tagline">One upload, all formats. Crop for Instagram, LinkedIn, and Stories instantly.</p>
        </header>

        <div class="tool-interface">
            <div class="drop-zone" id="drop-zone">
                <i class="fas fa-images"
                    style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 1rem;"></i>
                <p id="file-label">Upload your Master Image</p>
                <input type="file" id="file-input" accept="image/*" style="display: none;">
            </div>

            <div id="editor-area" style="display: none;">
                <div class="format-selector" style="flex-wrap: wrap; gap: 1rem;">
                    <!-- Auto-generated buttons will go here -->
                </div>

                <div id="preview-container"
                    style="margin: 2rem 0; overflow: hidden; border-radius: 12px; border: 1px solid var(--glass-border);">
                    <!-- Canvas will be injected here -->
                </div>

                <div class="action-buttons" style="justify-content: center;">
                    <button class="btn-action" id="download-all-btn">Download All Formats</button>
                </div>
            </div>

            <div class="result-area" id="result-area">
                <!-- Individual download links -->
            </div>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const editorArea = document.getElementById('editor-area');
        const previewContainer = document.getElementById('preview-container');
        const resultArea = document.getElementById('result-area');
        const downloadBtn = document.getElementById('download-all-btn');

        let originalImage = null;

        const formats = [
            { name: 'IG Square', width: 1080, height: 1080, icon: 'fa-instagram' },
            { name: 'IG Story', width: 1080, height: 1920, icon: 'fa-mobile-alt' },
            { name: 'LinkedIn Banner', width: 1584, height: 396, icon: 'fa-linkedin' }
        ];

        dropZone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', (e) => handleFile(e.target.files[0]));

        function handleFile(file) {
            if (!file || !file.type.startsWith('image/')) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                originalImage = new Image();
                originalImage.onload = () => initEditor();
                originalImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function initEditor() {
            dropZone.style.display = 'none';
            editorArea.style.display = 'block';
            generatePreviews();
        }

        function generatePreviews() {
            resultArea.innerHTML = '';
            resultArea.style.display = 'block';
            resultArea.style.animation = 'none';

            const grid = document.createElement('div');
            grid.style.cssText = "display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;";

            formats.forEach(fmt => {
                const canvas = document.createElement('canvas');
                canvas.width = fmt.width;
                canvas.height = fmt.height;
                const ctx = canvas.getContext('2d');

                // Smart Center Crop Logic
                const scale = Math.max(fmt.width / originalImage.width, fmt.height / originalImage.height);
                const x = (fmt.width / scale - originalImage.width) / 2;
                const y = (fmt.height / scale - originalImage.height) / 2;

                ctx.drawImage(originalImage, x, y, originalImage.width, originalImage.height, 0, 0, fmt.width, fmt.height);

                // Create Card
                const card = document.createElement('div');
                card.style.cssText = "background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; text-align: center;";

                const img = document.createElement('img');
                img.src = canvas.toDataURL('image/jpeg', 0.9);
                img.style.cssText = "width: 100%; height: 150px; object-fit: contain; border-radius: 8px; margin-bottom: 10px; background: #000;";

                const btn = document.createElement('a');
                btn.href = img.src;
                btn.download = `resized-${fmt.name.replace(' ', '-')}.jpg`;
                btn.className = "btn-action btn-sm";
                btn.style.cssText = "display: inline-block; padding: 0.5rem 1rem; font-size: 0.8rem; text-decoration: none;";
                btn.innerHTML = `<i class="fab ${fmt.icon}"></i> Download ${fmt.name}`;

                card.appendChild(img);
                card.appendChild(btn);
                grid.appendChild(card);
            });

            resultArea.appendChild(grid);
            downloadBtn.style.display = 'none'; // Individual downloads are better
        }
    </script>
</body>

</html>